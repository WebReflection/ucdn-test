import umap from"../../umap/esm/index.js";import{Hole,createCache,unroll}from"./rabbit.js";const{create:create,defineProperties:defineProperties}=Object,cache=umap(new WeakMap),tag=e=>{const t=umap(new WeakMap);return defineProperties((t,...a)=>new Hole(e,t,a),{for:{value(a,r){const n=t.get(a)||t.set(a,create(null));return n[r]||(n[r]=(t=>(a,...r)=>unroll(t,{type:e,template:a,values:r}))(createCache()))}},node:{value:(t,...a)=>unroll(createCache(),{type:e,template:t,values:a}).valueOf()}})};export const html=tag("html");export const svg=tag("svg");export const render=(e,t)=>{const a="function"==typeof t?t():t,r=cache.get(e)||cache.set(e,createCache()),n=a instanceof Hole?unroll(r,a):a;return n!==r.wire&&(r.wire=n,e.textContent="",e.appendChild(n.valueOf())),e};